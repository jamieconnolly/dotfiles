#!/bin/bash
# Symlink each dotfile into the $HOME directory.

set -e

cd "$(dirname "$0")/.."

for DOTFILE in $(pwd -P)/*; do
  [[ "$DOTFILE" == **/bin ]] && continue
  [[ "$DOTFILE" == **/LICENSE ]] && continue
  [[ "$DOTFILE" == **/README.md ]] && continue

  HOMEFILE="$HOME/.${DOTFILE##*/}"
  if [[ ! -e "$HOMEFILE" ]] || [[ $(ls -l "$HOMEFILE" | awk '{print $11}') != "$DOTFILE" ]]; then
    if [[ -L "$HOMEFILE" ]] && [[ ! -d "$DOTFILE" ]]; then
      ln -sfv "$DOTFILE" "$HOMEFILE"
    else
      rm -rf "$HOMEFILE"
      ln -sv "$DOTFILE" "$HOMEFILE"
    fi
  fi
done
